<h1>Çeviri Görevi</h1>

Durum: <%= @task.status %> <br>
<% if current_user == @task.translator && @task.in_progress?  %>
  <button class="btn btn-warning"><%= link_to "Çeviriyi Tamamla", complete_translation_path(@task), method: :put, style: "color: white" %>
  </button>  
<% elsif current_user == @task.owner && @task.pending_approval? %>
  <button class="btn btn-warning"><%= link_to "Çeviriyi Tamamla", complete_translation_path(@task), method: :put %>
  </button> <br>
  <%= link_to "Bitirme İsteğini Reddet", deny_complete_request_path(@task), method: :put %>
<% end %>

<h3>Versiyonlar</h3>
<% @task.version_trackers.each do |version_tracker| %>
  Versiyon Adı:<%= link_to version_tracker.name, version_tracker_path(version_tracker) %> <br>
  Açıklama:<%= version_tracker.description %> <br> <br>
<h4>Yorum Yap</h4>
  <% version_tracker.version_tracker_comments.each do |version_tracker_comment| %>
    <h5><b> <%= version_tracker_comment.content %> <br>
    <%= link_to version_tracker_comment.user.email, profile_path(version_tracker_comment.user) %> </b></h5> <br>
  <% end %>
    <%= render partial: 'version_tracker_comments/form', locals: {version_tracker: version_tracker} %>
<% end %>

<% if task_belongs_to_user?(@task, current_user) %>
  <button type="button" class="btn btn-info" data-toggle="modal" data-target="#create_version_tracker">Yeni Versiyon Ekle</button>
<% end %>

<!-- modal version_tracker dosyasına taşınacak -->
<!-- Modal -->
<div id="create_version_tracker" class="modal fade" role="dialog">
 <div class="modal-dialog">
   <!-- Modal content-->
  <div class="modal-content">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal">&times;</button>
      <h4 class="modal-title">İstek Oluştur</h4>
    </div>
    <div class="modal-body">
     <%= simple_form_for(@task.version_trackers.build, url: create_version_tracker_path, method: 'post') do |f| %>
        <%= f.input :name %>
        <%= f.input :description %>
        <%= f.input :task_id, as: 'hidden', input_html: { value: @task.id} %>
        <%= f.simple_fields_for :version_tracker_material do |m| %>
          <%= m.input :description %>
          <%= m.input :material, as: :file %>
        <% end %>
        <%= f.button :submit, class: "btn btn-success" %>
     <% end %>      
    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-info" data-toggle="modal" data-target="#create_version_tracker">Vazgeç</button>
    </div>
   </div>
  </div>
 </div>